<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Cafe★Log</title>
    <!-- Cache buster: 2025-06-20-21:15 HEADER_OPTIMIZE -->
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- Theme Colors -->
    <meta name="theme-color" content="#00704A">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    
    <!-- Favicon -->
    <link rel="icon" type="image/svg+xml" href="images/logo.svg">
    
    <!-- Critical CSS -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/themes.css">
    <!-- Non-critical CSS with preload -->
    <link rel="preload" href="css/components.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="css/components.css"></noscript>
    <link rel="preload" href="css/mobile.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="css/mobile.css"></noscript>
    <link rel="preload" href="css/badges.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="css/badges.css"></noscript>
    <link rel="preload" href="css/debug.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="css/debug.css"></noscript>
    <link rel="preload" href="css/splash.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="css/splash.css"></noscript>
    
    <!-- Google Maps API -->
    <script async defer
        src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCcx2v4xS9VuQjHzhME5Fz3Uazig3l62RI&libraries=places,geometry">
    </script>
    <!-- MarkerClusterer -->
    <script src="https://unpkg.com/@googlemaps/markerclusterer/dist/index.min.js"></script>
</head>
<body data-theme="light">
    <!-- Header -->
    <header class="header">
        <button class="hamburger-btn" id="hamburger">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <div class="logo-container">
            <img src="images/logo.svg" alt="ロゴ" class="logo">
            <h1 class="app-title">Cafe★Log</h1>
        </div>
    </header>

    <!-- Hamburger Menu -->
    <nav class="hamburger-menu" id="hamburgerMenu">
        <div class="menu-overlay" id="menuOverlay"></div>
        <div class="menu-content">
            <ul class="menu-list">
                <li><a href="#" data-action="theme">テーマ切替</a></li>
                <li><a href="#" data-action="qr">QRコード</a></li>
                <li><a href="#" data-action="notices">お知らせ</a></li>
                <li><a href="#" data-action="disclaimer">免責事項</a></li>
                <li><a href="#" data-action="licenses">ライセンス情報</a></li>
                <li><a href="#" data-action="credits">クレジット</a></li>
                <li><a href="#" data-action="store-update">店舗データ更新</a></li>
                <li><a href="#" data-action="reset">データ初期化</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="main-content">
        <!-- Section Navigation -->
        <nav class="section-nav">
            <button class="section-btn active" data-section="top">トップ</button>
            <button class="section-btn" data-section="stores">店舗リスト</button>
            <button class="section-btn" data-section="achievements">実績</button>
        </nav>

        <!-- Top Section -->
        <section class="section active" id="top-section">
            <div class="quick-access">
                <h2>マイエリア</h2>
                <div class="my-areas-grid" id="myAreasGrid">
                    <!-- Dynamic content -->
                </div>
            </div>
            <div class="map-container">
                <div id="map"></div>
            </div>
        </section>

        <!-- Store List Section -->
        <section class="section" id="stores-section">
            <div class="store-navigation">
                <div class="breadcrumb" id="breadcrumb"></div>
                <div class="search-container">
                    <input type="text" id="storeSearch" placeholder="店舗名で検索...">
                </div>
            </div>
            <div class="store-content" id="storeContent">
                <!-- Dynamic content -->
            </div>
        </section>

        <!-- Achievements Section -->
        <section class="section" id="achievements-section">
            <div class="achievements-nav">
                <button class="achievement-tab active" data-tab="progress">達成率</button>
                <button class="achievement-tab" data-tab="map">地図</button>
            </div>
            <div class="achievement-content">
                <div class="achievement-tab-content active" id="progress-tab">
                    <!-- Progress bars and badges -->
                </div>
                <div class="achievement-tab-content" id="map-tab">
                    <div id="achievementMap"></div>
                </div>
            </div>
        </section>
    </main>


    <!-- Modal Templates -->
    <div class="modal" id="themeModal">
        <div class="modal-content">
            <h3>テーマ選択</h3>
            <div class="theme-options">
                <button class="theme-btn" data-theme="light">ライト</button>
                <button class="theme-btn" data-theme="dark">ダーク</button>
                <button class="theme-btn" data-theme="starbucks">グリーン</button>
            </div>
            <button class="modal-close">閉じる</button>
        </div>
    </div>

    <!-- JavaScript - Optimized with defer for non-blocking rendering -->
    <script defer src="js/components/splash.js"></script>
    <script defer src="js/debug-menu.js"></script>
    <script defer src="js/utils/storage.js"></script>
    <script defer src="js/utils/data-integration.js"></script>
    <script defer src="tools/data-updater.js"></script>
    <script defer src="js/components/update-manager.js?v=20250620g_fix"></script>
    <script defer src="js/utils/progress.js"></script>
    <script defer src="js/utils/qr.js"></script>
    <script defer src="js/utils/touch.js"></script>
    <script defer src="js/utils/performance.js"></script>
    <script defer src="js/utils/scraper.js"></script>
    <script defer src="js/components/header.js?v=20250620b"></script>
    <script defer src="js/components/navigation.js"></script>
    <script defer src="js/components/map.js?v=minimal"></script>
    <script defer src="js/pages/top.js"></script>
    <script defer src="js/pages/stores.js"></script>
    <script defer src="js/pages/achievements.js?v=svg3"></script>
    <script defer src="js/app.js"></script>
</body>
</html>